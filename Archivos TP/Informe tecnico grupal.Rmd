---
title: "Informe Tecnico"
output:
  html_document: default
  pdf_document: default
date: "2025-04-11"
---

## Instalacion de librerias para informe preliminar

  Librerias necesarias para el informe.

```{r}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message=FALSE)
packages <- c("readxl", "dplyr", "tidyr", "data.table", "stringr")
```

  Instalacion de librerías.

```{r}
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}
```

  Carga de librerías.

```{r message=FALSE, warning=FALSE}
invisible(lapply(packages, library, character.only = TRUE))
```

## Tratamiento de datos de barrios

  Carga de datos sobre encuentas realizadas por barrios, provincia y region. Vemos que los datos requiren un tratamiento previo al analisis por campos vacíos.

```{r}
bu <- read_excel(path = "./Barrios_Usuarios.xlsx") %>% data.frame()

bu %>% head(10)
```

  Realizamos un tratamiento de los datos de encuestas en barrios completando campos faltantes y eliminando filas con encuestas vacias. 

```{r}
bu <- bu %>% fill(REGIÓN, .direction = 'down')
bu <- bu %>% fill(PROVINCIA, .direction = 'down')
bu <- bu %>% drop_na(ENCUESTAS)
bu <- bu %>% fill(BARRIO, .direction = 'down')

bu %>% group_by(BARRIO) %>% filter(n() > 1)
```
  Se observa que los barrios se repiten, es decir que algunos tienen varias encuestas. Para facilitar el analisis posterior vamos a sumar estos valores.

```{r message=FALSE}
bu <- bu %>% group_by(REGIÓN, PROVINCIA, BARRIO) %>% summarise("TOTAL ENCUESTAS" = sum(ENCUESTAS))
```

## Analisis de barrios

  En este informe analizaremos los resultado de encuestas realizados sobre los barrios detallados debajo, en distintas regiones en Argentina. Se muestra además la cantidad total de encuestas realizadas sobre cada barrio.

```{r}
bu %>% group_by(REGIÓN) %>% summarise("TOTAL ENCUESTAS" = sum(`TOTAL ENCUESTAS`))
```

```{r}
bu %>% group_by(PROVINCIA) %>% summarise("TOTAL ENCUESTAS" = sum(`TOTAL ENCUESTAS`))
```

```{r}
bu %>% group_by(BARRIO) %>% summarise("TOTAL ENCUESTAS" = sum(`TOTAL ENCUESTAS`))
```

## Tratamiento de datos de encuesta

  Se analizarán las respuestas sobre las encuentas realizadas que han sido documentadas en el archivo 'Datos_LP'. Esta información originalmente no posee las características de datos ordenados según las librerías que se pretender utilizar.  Para ello, se tratarán los datos para lograr una estructura 'tidy', esto es:
  - Cada columna será una variable, es decir, una pregunta de la encuesta.
  - Cada fila un resultado de encuesta dado por grupo familia.
  - Cada valor será el la respuesta dada a una pregunta por el grupo familiar.

Con este objetivo entonces se realizan las siguientes transformaciones:
  - Unificacición de los títulos multinivel (Sección, referencia y pregunta) en el archivo.
  - Identificación parcial de cada pregunta y su respuesta asociada (para una posterior verificación de consistencia en los datos)


```{r message=FALSE, warning=FALSE}
dh <- read_excel(path = "./Datos_LP.xlsx", n_max = 3, col_names = FALSE) 
dh <- dh %>% transpose() %>% fill(V1, V2, V3, .direction = 'down')
colnames(dh) <-c('SECCIONES', 'REFERENCIA', 'PREGUNTA')
dh <- dh[-1:-3,]
dh <- dh %>% group_by(PREGUNTA) %>% mutate(ID = row_number(PREGUNTA))
dh$ID <- paste(dh$REFERENCIA, dh$ID, sep = "_")
dh$ID <- paste("id", dh$ID, sep = "_")
dh
```

```{r}
dh %>% group_by(SECCIONES) %>% summarize('TOTAL PREGUNTAS' = n())
```
```{r}
dh %>% group_by(PREGUNTA) %>% summarize('TOTAL OPCIONES DE RESPUESTAS' = n())
```

  Utilizaremos esta información parcial para agrupar respuestas en la base de datos original.

```{r message=FALSE, warning=FALSE, include=FALSE}
cn2 <- dh %>% transpose()
cn2 <- cn2[4,]
cn2
cn1 <- c('ORDEN', 'PROVINCIA', 'BARRIO')
col_names <- c(cn1, cn2) %>% as.character()
#col_names[duplicated(col_names)]
#col_names
```


```{r}
df <- read_excel(path = "./Datos_LP.xlsx", skip = 3, col_names = col_names) %>% data.frame()

df %>% head(10)
```

```{r}
dh

nn <- dh %>%
  summarise(across(.fns = paste, collapse = "_")) %>%
  unlist() %>% unname()

nn
```


## Analisis de barrios

```{r}
df %>% transpose()
```

## Seleccion de variables de estudio para descripciones graficas

### Variable categórica medida en escala nominal

  COMPLETAR


###  Variable categórica medida en escala ordinal

  COMPLETAR

### Variable categórica de respuesta múltiple

  Nos interesaria analizar la pregunta "10.6.2. ¿Hay plagas en su vivienda y en los alrededores de la misma? ¿Cuales?". Que tiene como respuestas las opciones Cucarachas, Mosquitos y o Ratas. Para ver si existe una relacion con la cantidad de personas que duermen en una misma habitacion. Esta informaicion se obiene de la pregunta "3.2. ¿Cuál es el número MÁXIMO de personas que duermen en estos dormitorios usualmente? (Opciones: 1 a más de 10)"


```{r}
summary(df$...93)
```


### Variable cuantitativa discreta

  COMPLETAR CON 1.4

### Variable cuantitativa continua

  COMPLETAR CON 4.4.1


## Medidas de posicion seleccionadas

  COMPLETAR CON medida de posición que mejor acompañe a los recursos gráficos
anteriormente mencionados

  COMPLETAR CON consideraciones sobre la dispersión de las variables (puede ser a través de una medida resumen o a partir de algún recurso gráfico), en aquellos casos en los que sea apropiado


## Descripciones graficas de la relación entre variables

### Dos variables categóricas

  COMPLETAR CON 7.2 y 7.4

### Una variable categórica y una variable cuantitativa

  COMPLETAR CON
  5.3. ¿Cómo es la presión del agua?
  5.3.1. Buena / Débil / Muy débil
  5.4. ¿Cuál es el gasto promedio que destinan a este servicio de agua?

### Dos variables cuantitativas

  COMPLETAR